{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import{signIn,signUp,signOut}from'@aws-amplify/auth';import styles from'./LoginForm.module.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function LoginForm(_ref){let{setIsLoggedIn}=_ref;const[username,setUsername]=useState('');const[password,setPassword]=useState('');const[error,setError]=useState('');const[isLogin,setIsLogin]=useState(true);const navigate=useNavigate();useEffect(()=>{const clearSession=async()=>{try{await signOut();setIsLoggedIn(false);}catch(error){console.error('サインアウトエラー:',error);}};clearSession();},[setIsLoggedIn]);const handleSubmit=async e=>{e.preventDefault();setError('');try{if(isLogin){const{isSignedIn}=await signIn({username,password});if(isSignedIn){setIsLoggedIn(true);navigate('/send');}}else{await signUp({username,password,options:{userAttributes:{email:username}}});setError('登録が完了しました。ログインしてください。');setIsLogin(true);}}catch(error){console.error('認証エラー:',error);setError(getErrorMessage(error));}};const getErrorMessage=error=>{switch(error.name){case'NotAuthorizedException':return'ユーザー名またはパスワードが正しくありません。';case'UserNotFoundException':return'ユーザーが見つかりません。';case'UserNotConfirmedException':return'ユーザーの確認が完了していません。';default:return'認証中にエラーが発生しました。もう一度お試しください。';}};return/*#__PURE__*/_jsx(\"div\",{className:styles.container,children:/*#__PURE__*/_jsxs(\"div\",{className:styles.formContainer,children:[/*#__PURE__*/_jsx(\"h2\",{className:styles.title,children:isLogin?'ログイン':'新規登録'}),error&&/*#__PURE__*/_jsx(\"p\",{className:styles.error,children:error}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:styles.form,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.formGroup,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"username\",className:styles.label,children:\"\\u30E6\\u30FC\\u30B6\\u30FC\\u540D:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"username\",value:username,onChange:e=>setUsername(e.target.value),required:true,className:styles.input,autoComplete:isLogin?\"username\":\"new-username\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.formGroup,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",className:styles.label,children:\"\\u30D1\\u30B9\\u30EF\\u30FC\\u30C9:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"password\",value:password,onChange:e=>setPassword(e.target.value),required:true,className:styles.input,autoComplete:isLogin?\"current-password\":\"new-password\"})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:styles.submitButton,children:isLogin?'ログイン':'登録'}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setIsLogin(!isLogin),className:styles.toggleButton,children:isLogin?'新規登録はこちら':'ログインはこちら'})]})]})});}","map":{"version":3,"names":["React","useState","useEffect","useNavigate","signIn","signUp","signOut","styles","jsx","_jsx","jsxs","_jsxs","LoginForm","_ref","setIsLoggedIn","username","setUsername","password","setPassword","error","setError","isLogin","setIsLogin","navigate","clearSession","console","handleSubmit","e","preventDefault","isSignedIn","options","userAttributes","email","getErrorMessage","name","className","container","children","formContainer","title","onSubmit","form","formGroup","htmlFor","label","type","id","value","onChange","target","required","input","autoComplete","submitButton","onClick","toggleButton"],"sources":["/Users/yaki/digi-coin/digi-coin-app/src/components/LoginForm.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { signIn, signUp, signOut } from '@aws-amplify/auth';\nimport styles from './LoginForm.module.css';\n\nexport default function LoginForm({ setIsLoggedIn }) {\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const [error, setError] = useState('');\n  const [isLogin, setIsLogin] = useState(true);\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    const clearSession = async () => {\n      try {\n        await signOut();\n        setIsLoggedIn(false);\n      } catch (error) {\n        console.error('サインアウトエラー:', error);\n      }\n    };\n    clearSession();\n  }, [setIsLoggedIn]);\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    setError('');\n\n    try {\n      if (isLogin) {\n        const { isSignedIn } = await signIn({ username, password });\n        if (isSignedIn) {\n          setIsLoggedIn(true);\n          navigate('/send');\n        }\n      } else {\n        await signUp({\n          username,\n          password,\n          options: {\n            userAttributes: {\n              email: username\n            }\n          }\n        });\n        setError('登録が完了しました。ログインしてください。');\n        setIsLogin(true);\n      }\n    } catch (error) {\n      console.error('認証エラー:', error);\n      setError(getErrorMessage(error));\n    }\n  };\n\n  const getErrorMessage = (error) => {\n    switch (error.name) {\n      case 'NotAuthorizedException':\n        return 'ユーザー名またはパスワードが正しくありません。';\n      case 'UserNotFoundException':\n        return 'ユーザーが見つかりません。';\n      case 'UserNotConfirmedException':\n        return 'ユーザーの確認が完了していません。';\n      default:\n        return '認証中にエラーが発生しました。もう一度お試しください。';\n    }\n  };\n\n  return (\n    <div className={styles.container}>\n      <div className={styles.formContainer}>\n        <h2 className={styles.title}>\n          {isLogin ? 'ログイン' : '新規登録'}\n        </h2>\n        {error && <p className={styles.error}>{error}</p>}\n        <form onSubmit={handleSubmit} className={styles.form}>\n          <div className={styles.formGroup}>\n            <label htmlFor=\"username\" className={styles.label}>ユーザー名:</label>\n            <input\n              type=\"text\"\n              id=\"username\"\n              value={username}\n              onChange={(e) => setUsername(e.target.value)}\n              required\n              className={styles.input}\n              autoComplete={isLogin ? \"username\" : \"new-username\"}\n            />\n          </div>\n          <div className={styles.formGroup}>\n            <label htmlFor=\"password\" className={styles.label}>パスワード:</label>\n            <input\n              type=\"password\"\n              id=\"password\"\n              value={password}\n              onChange={(e) => setPassword(e.target.value)}\n              required\n              className={styles.input}\n              autoComplete={isLogin ? \"current-password\" : \"new-password\"}\n            />\n          </div>\n          <button type=\"submit\" className={styles.submitButton}>\n            {isLogin ? 'ログイン' : '登録'}\n          </button>\n          <button\n            type=\"button\"\n            onClick={() => setIsLogin(!isLogin)}\n            className={styles.toggleButton}\n          >\n            {isLogin ? '新規登録はこちら' : 'ログインはこちら'}\n          </button>\n        </form>\n      </div>\n    </div>\n  );\n}\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}