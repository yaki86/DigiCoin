{"ast":null,"code":"import { ConsoleLogger } from '../Logger/ConsoleLogger.mjs';\nimport { NO_HUBCALLBACK_PROVIDED_EXCEPTION } from '../constants.mjs';\nimport { AmplifyError } from '../errors/AmplifyError.mjs';\nimport '../types/errors.mjs';\nimport '../errors/errorHelpers.mjs';\n\n// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nconst AMPLIFY_SYMBOL = typeof Symbol !== 'undefined' ? Symbol('amplify_default') : '@@amplify_default';\nconst logger = new ConsoleLogger('Hub');\nclass HubClass {\n  constructor(name) {\n    this.listeners = new Map();\n    this.protectedChannels = ['core', 'auth', 'api', 'analytics', 'interactions', 'pubsub', 'storage', 'ui', 'xr'];\n    this.name = name;\n  }\n  /**\n   * Used internally to remove a Hub listener.\n   *\n   * @remarks\n   * This private method is for internal use only. Instead of calling Hub.remove, call the result of Hub.listen.\n   */\n  _remove(channel, listener) {\n    const holder = this.listeners.get(channel);\n    if (!holder) {\n      logger.warn(`No listeners for ${channel}`);\n      return;\n    }\n    this.listeners.set(channel, [...holder.filter(_ref => {\n      let {\n        callback\n      } = _ref;\n      return callback !== listener;\n    })]);\n  }\n  dispatch(channel, payload, source, ampSymbol) {\n    if (typeof channel === 'string' && this.protectedChannels.indexOf(channel) > -1) {\n      const hasAccess = ampSymbol === AMPLIFY_SYMBOL;\n      if (!hasAccess) {\n        logger.warn(`WARNING: ${channel} is protected and dispatching on it can have unintended consequences`);\n      }\n    }\n    const capsule = {\n      channel,\n      payload: {\n        ...payload\n      },\n      source,\n      patternInfo: []\n    };\n    try {\n      this._toListeners(capsule);\n    } catch (e) {\n      logger.error(e);\n    }\n  }\n  listen(channel, callback) {\n    let listenerName = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'noname';\n    let cb;\n    if (typeof callback !== 'function') {\n      throw new AmplifyError({\n        name: NO_HUBCALLBACK_PROVIDED_EXCEPTION,\n        message: 'No callback supplied to Hub'\n      });\n    } else {\n      // Needs to be casted as a more generic type\n      cb = callback;\n    }\n    let holder = this.listeners.get(channel);\n    if (!holder) {\n      holder = [];\n      this.listeners.set(channel, holder);\n    }\n    holder.push({\n      name: listenerName,\n      callback: cb\n    });\n    return () => {\n      this._remove(channel, cb);\n    };\n  }\n  _toListeners(capsule) {\n    const {\n      channel,\n      payload\n    } = capsule;\n    const holder = this.listeners.get(channel);\n    if (holder) {\n      holder.forEach(listener => {\n        logger.debug(`Dispatching to ${channel} with `, payload);\n        try {\n          listener.callback(capsule);\n        } catch (e) {\n          logger.error(e);\n        }\n      });\n    }\n  }\n}\n/* We export a __default__ instance of HubClass to use it as a\npseudo Singleton for the main messaging bus, however you can still create\nyour own instance of HubClass() for a separate \"private bus\" of events. */\nconst Hub = new HubClass('__default__');\n/**\n * @internal\n *\n * Internal hub used for core Amplify functionality. Not intended for use outside of Amplify.\n *\n */\nconst HubInternal = new HubClass('internal-hub');\nexport { AMPLIFY_SYMBOL, Hub, HubClass, HubInternal };","map":{"version":3,"names":["AMPLIFY_SYMBOL","Symbol","logger","ConsoleLogger","HubClass","constructor","name","listeners","Map","protectedChannels","_remove","channel","listener","holder","get","warn","set","filter","_ref","callback","dispatch","payload","source","ampSymbol","indexOf","hasAccess","capsule","patternInfo","_toListeners","e","error","listen","listenerName","arguments","length","undefined","cb","AmplifyError","NO_HUBCALLBACK_PROVIDED_EXCEPTION","message","push","forEach","debug","Hub","HubInternal"],"sources":["/Users/yaki/digi-coin/digi-coin-app/node_modules/@aws-amplify/core/src/Hub/index.ts"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { ConsoleLogger } from '../Logger';\nimport { NO_HUBCALLBACK_PROVIDED_EXCEPTION } from '../constants';\nimport { AmplifyError } from '../errors';\nexport const AMPLIFY_SYMBOL = (typeof Symbol !== 'undefined'\n    ? Symbol('amplify_default')\n    : '@@amplify_default');\nconst logger = new ConsoleLogger('Hub');\nexport class HubClass {\n    constructor(name) {\n        this.listeners = new Map();\n        this.protectedChannels = [\n            'core',\n            'auth',\n            'api',\n            'analytics',\n            'interactions',\n            'pubsub',\n            'storage',\n            'ui',\n            'xr',\n        ];\n        this.name = name;\n    }\n    /**\n     * Used internally to remove a Hub listener.\n     *\n     * @remarks\n     * This private method is for internal use only. Instead of calling Hub.remove, call the result of Hub.listen.\n     */\n    _remove(channel, listener) {\n        const holder = this.listeners.get(channel);\n        if (!holder) {\n            logger.warn(`No listeners for ${channel}`);\n            return;\n        }\n        this.listeners.set(channel, [\n            ...holder.filter(({ callback }) => callback !== listener),\n        ]);\n    }\n    dispatch(channel, payload, source, ampSymbol) {\n        if (typeof channel === 'string' &&\n            this.protectedChannels.indexOf(channel) > -1) {\n            const hasAccess = ampSymbol === AMPLIFY_SYMBOL;\n            if (!hasAccess) {\n                logger.warn(`WARNING: ${channel} is protected and dispatching on it can have unintended consequences`);\n            }\n        }\n        const capsule = {\n            channel,\n            payload: { ...payload },\n            source,\n            patternInfo: [],\n        };\n        try {\n            this._toListeners(capsule);\n        }\n        catch (e) {\n            logger.error(e);\n        }\n    }\n    listen(channel, callback, listenerName = 'noname') {\n        let cb;\n        if (typeof callback !== 'function') {\n            throw new AmplifyError({\n                name: NO_HUBCALLBACK_PROVIDED_EXCEPTION,\n                message: 'No callback supplied to Hub',\n            });\n        }\n        else {\n            // Needs to be casted as a more generic type\n            cb = callback;\n        }\n        let holder = this.listeners.get(channel);\n        if (!holder) {\n            holder = [];\n            this.listeners.set(channel, holder);\n        }\n        holder.push({\n            name: listenerName,\n            callback: cb,\n        });\n        return () => {\n            this._remove(channel, cb);\n        };\n    }\n    _toListeners(capsule) {\n        const { channel, payload } = capsule;\n        const holder = this.listeners.get(channel);\n        if (holder) {\n            holder.forEach(listener => {\n                logger.debug(`Dispatching to ${channel} with `, payload);\n                try {\n                    listener.callback(capsule);\n                }\n                catch (e) {\n                    logger.error(e);\n                }\n            });\n        }\n    }\n}\n/* We export a __default__ instance of HubClass to use it as a\npseudo Singleton for the main messaging bus, however you can still create\nyour own instance of HubClass() for a separate \"private bus\" of events. */\nexport const Hub = new HubClass('__default__');\n/**\n * @internal\n *\n * Internal hub used for core Amplify functionality. Not intended for use outside of Amplify.\n *\n */\nexport const HubInternal = new HubClass('internal-hub');\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}